#' Shift Factor
#'
#' Moves coordinates given by \code{\link{coord_facets}} to position nested
#' facet charts in \code{\link{coord_nested}}.
#'
#' @param data list generated by \code{\link{coord_facets}}.
#' @param x integer; horizontal shift.
#' @param y integer; vertical shift.
#'
#' @details Helper function of \code{\link{coord_nested}}.
#'
#' @return List containing a limited selection of coordinates.
shift_factor <- function (data, x, y) {


  # stripping off superfluous information
  d <- data[c("c_circs",
              "c_axes",
              "test_label",
              "cors")]
  d$axis_tick[1:2] <- list(NULL) # polar coordinates not needed anymore

  # moving on the x axis by adding x shift to all x coordinates
  d$c_circs$x <- d$c_circs$x + x
  d$c_axes$x0 <- d$c_axes$x0 + x
  d$c_axes$x1 <- d$c_axes$x1 + x
  d$c_axes$x2 <- d$c_axes$x2 + x
  d$c_axes$x3 <- d$c_axes$x3 + x
  d$axis_tick$x <- d$axis_tick$x + x
  d$test_label$x <- d$test_label$x + x
  d$cors$x <- d$cors$x + x

  # moving on the y axis by adding y shift to all y coordinates
  d$c_circs$y <- d$c_circs$y + y
  d$c_axes$y0 <- d$c_axes$y0 + y
  d$c_axes$y1 <- d$c_axes$y1 + y
  d$c_axes$y2 <- d$c_axes$y2 + y
  d$c_axes$y3 <- d$c_axes$y3 + y
  d$test_label$y <- d$test_label$y + y
  d$cors$y <- d$cors$y + y

  return(d)
}
